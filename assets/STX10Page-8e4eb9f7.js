import{_ as U,u as z,y as A,r as n,b as Q,o,d as b,j as e,w as a,l as g,i as k,n as X,k as w,f as p,e as c,t as r,p as R,q as F}from"./index-d391c2de.js";import{C as y}from"./ContractHelper-526dc384.js";import{U as m}from"./utils-b205d640.js";import"./browser-ponyfill-593c1223.js";const j=X(),E={name:"STX10Page",components:{},data(){return{bSignedIn:z.isUserSignedIn(),defaultReadonlyAddress:j.defaultContractAddress,progressColors:[{color:"#5cb87a",percentage:33},{color:"#e6a23c",percentage:66},{color:"#f56c6c",percentage:100}],selfAddress:"",activeTabName:"tick-list",tickListDatas:{queryTick:"",queryState:0,state:0,pageLimit:8,total:0,curPage:1,cacheTableData:[],tableData:[]},queryBalanceDatas:{tick:"",address:"",loadState:0,balance:0,block:0,tokenId:0,max:0,lim:0,supply:0,progress:0}}},computed:{queryTickBtnValid(){return/^[a-z]{2,16}$/i.test(m.trimLower(this.tickListDatas.queryTick))},queryBalanceBtnValid(){return/^[a-z]{2,16}$/i.test(m.trimLower(this.queryBalanceDatas.tick))&&m.parseAddress(this.queryBalanceDatas.address)!=null}},async mounted(){this.queryTickList(1);const l=await y.loadSummary();this.tickListDatas.total=parseInt(l.last_stx10_tick_index)},methods:{async queryTickList(l){this.tickListDatas.state=1;const s=(l-1)*this.tickListDatas.pageLimit;let d=[];for(let t=1;t<=this.tickListDatas.pageLimit;t++)d.push(s+t);const f=await y.queryTickList(d);for(let t of f)t.supply>=t.max?t.progress=100:t.progress=Number(t.supply*1000n/t.max)/10;this.tickListDatas.state=2,this.tickListDatas.tableData.splice(0,this.tickListDatas.tableData.length),this.tickListDatas.tableData.push(...f),this.tickListDatas.cacheTableData=null},onClickChangePage(){this.queryTickList(this.tickListDatas.curPage)},async onClickQueryTick(){const l=m.trimLower(this.tickListDatas.queryTick);if(l.length==0){this.tickListDatas.cacheTableData&&(this.tickListDatas.tableData.splice(0,this.tickListDatas.tableData.length),this.tickListDatas.tableData.push(...this.tickListDatas.cacheTableData),this.tickListDatas.cacheTableData=null);return}if(!this.queryTickBtnValid)return;this.tickListDatas.queryState=1;const s=await y.resolveSTX10InfoByTick(l);if(this.tickListDatas.queryState=2,this.tickListDatas.cacheTableData||(this.tickListDatas.cacheTableData=[],this.tickListDatas.cacheTableData.push(...this.tickListDatas.tableData)),this.tickListDatas.tableData.splice(0,this.tickListDatas.tableData.length),s.block>0){let d=0;s.supply>=s.max?d=100:d=Number(s.supply*1000n/s.max)/10,this.tickListDatas.tableData.push({tick:l,block:s.block,max:s.max,lim:s.lim,supply:s.supply,progress:d})}},async onClickQueryBalance(){this.queryBalanceDatas.loadState=1;const l=await y.resolveSTX10InfoByTick(m.trimLower(this.queryBalanceDatas.tick));this.queryBalanceDatas.block=l.block,this.queryBalanceDatas.max=l.max,this.queryBalanceDatas.lim=l.lim,this.queryBalanceDatas.supply=l.supply,this.queryBalanceDatas.progress=l.max>0?Number(l.lim*100n/l.max):0,this.queryBalanceDatas.balance=await y.loadSTX10Balance(m.trimLower(this.queryBalanceDatas.tick),this.queryBalanceDatas.address.trim()),this.queryBalanceDatas.loadState=2},onClickFillAddress(){this.queryBalanceDatas.address=A()}}},u=l=>(R("data-v-a84a14f1"),l=l(),F(),l),H={id:"main"},G=u(()=>c("div",{id:"title"},"stx10",-1)),J={key:0},K={key:1,class:"queryResult"},M={class:"resultDiv"},O=u(()=>c("span",null,"balance:",-1)),W=u(()=>c("div",{style:{"border-bottom":"1px solid #666",height:"16px"}},"Â ",-1)),Y={class:"resultDiv"},Z=u(()=>c("span",null,"max:",-1)),$={class:"resultDiv"},tt=u(()=>c("span",null,"supply:",-1)),et=u(()=>c("span",null,"minted:",-1)),at={class:"resultDiv"},st=u(()=>c("span",null,"lim:",-1)),lt={key:0},it={class:"tickName"},ct={class:"queryResultTxt"},nt=u(()=>c("span",null,"minted:",-1)),ot={class:"queryResultTxt"},rt={class:"queryResultTxt"};function ut(l,s,d,f,t,_){const L=n("el-input"),D=n("el-col"),q=n("el-button"),S=n("el-row"),v=n("el-tab-pane"),B=n("el-form-item"),x=n("el-progress"),T=n("el-space"),V=n("el-form"),I=n("el-tabs"),h=n("el-table-column"),N=n("el-table"),P=n("el-pagination"),C=Q("loading");return o(),b("div",H,[G,e(I,{modelValue:t.activeTabName,"onUpdate:modelValue":s[3]||(s[3]=i=>t.activeTabName=i),size:"large"},{default:a(()=>[e(v,{label:"Tick list",name:"tick-list"},{default:a(()=>[e(S,{style:{margin:"16px auto"}},{default:a(()=>[e(D,{span:6},{default:a(()=>[e(L,{modelValue:t.tickListDatas.queryTick,"onUpdate:modelValue":s[0]||(s[0]=i=>t.tickListDatas.queryTick=i),placeholder:"",clearable:"",onChange:_.onClickQueryTick},null,8,["modelValue","onChange"])]),_:1}),w((o(),g(q,{type:"primary",disabled:!_.queryTickBtnValid},{default:a(()=>[p("Query")]),_:1},8,["disabled"])),[[C,t.tickListDatas.queryState==1]])]),_:1})]),_:1}),e(v,{label:"Query balance",name:"query-balance"},{default:a(()=>[e(V,{model:t.queryBalanceDatas,"label-width":"80px",class:"tabInner",size:"large"},{default:a(()=>[e(B,{label:"tick"},{default:a(()=>[e(D,{span:14},{default:a(()=>[e(L,{modelValue:t.queryBalanceDatas.tick,"onUpdate:modelValue":s[1]||(s[1]=i=>t.queryBalanceDatas.tick=i),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(B,{label:"address"},{default:a(()=>[e(D,{span:14},{default:a(()=>[e(L,{modelValue:t.queryBalanceDatas.address,"onUpdate:modelValue":s[2]||(s[2]=i=>t.queryBalanceDatas.address=i),placeholder:""},null,8,["modelValue"])]),_:1}),t.bSignedIn?(o(),g(D,{key:0,span:4},{default:a(()=>[e(q,{style:{"margin-left":"4px"},type:"primary",plain:"",onClick:_.onClickFillAddress},{default:a(()=>[p("Fill current account")]),_:1},8,["onClick"])]),_:1})):k("",!0)]),_:1}),e(B,null,{default:a(()=>[e(T,{direction:"vertical",alignment:"start"},{default:a(()=>[w((o(),g(q,{type:"primary",onClick:_.onClickQueryBalance,disabled:!_.queryBalanceBtnValid},{default:a(()=>[p("Query")]),_:1},8,["onClick","disabled"])),[[C,t.queryBalanceDatas.loadState==1]]),t.queryBalanceDatas.loadState==2&&t.queryBalanceDatas.block==0?(o(),b("div",J,"Tick not exist")):k("",!0),t.queryBalanceDatas.loadState==2&&t.queryBalanceDatas.block>0?(o(),b("div",K,[c("div",M,[O,p(" "+r(t.queryBalanceDatas.balance),1)]),W,c("div",Y,[Z,p(" "+r(t.queryBalanceDatas.max),1)]),c("div",$,[tt,p(" "+r(t.queryBalanceDatas.supply),1)]),e(T,{alignment:"center",class:"resultDiv"},{default:a(()=>[et,e(x,{style:{width:"300px"},percentage:t.queryBalanceDatas.progress,color:t.progressColors,"stroke-width":8},null,8,["percentage","color"])]),_:1}),c("div",at,[st,p(" "+r(t.queryBalanceDatas.lim),1)])])):k("",!0)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["modelValue"]),t.activeTabName=="tick-list"&&t.tickListDatas.state==2?(o(),b("div",lt,[e(N,{size:"large",data:t.tickListDatas.tableData,"empty-text":"No ticks"},{default:a(()=>[e(h,{label:"tick",width:"180"},{default:a(i=>[c("div",it,r(i.row.tick),1)]),_:1}),e(h,{label:"state"},{default:a(i=>[c("div",ct,[c("div",null,"max: "+r(i.row.max),1),e(T,{alignment:"center"},{default:a(()=>[nt,e(x,{style:{"min-width":"250px"},percentage:i.row.progress,color:t.progressColors,"stroke-width":8},null,8,["percentage","color"])]),_:2},1024)])]),_:1}),e(h,{label:"supply",width:"150"},{default:a(i=>[c("div",ot,r(i.row.supply),1)]),_:1}),e(h,{label:"lim",width:"150"},{default:a(i=>[c("div",rt,r(i.row.lim),1)]),_:1})]),_:1},8,["data"]),t.tickListDatas.state==2&&t.tickListDatas.total>t.tickListDatas.pageLimit?(o(),g(P,{key:0,style:{"margin-top":"16px"},background:"",layout:"total, prev, pager, next","default-page-size":t.tickListDatas.pageLimit,"current-page":t.tickListDatas.curPage,"onUpdate:currentPage":s[4]||(s[4]=i=>t.tickListDatas.curPage=i),total:t.tickListDatas.total,onCurrentChange:_.onClickChangePage},null,8,["default-page-size","current-page","total","onCurrentChange"])):k("",!0)])):k("",!0)])}const kt=U(E,[["render",ut],["__scopeId","data-v-a84a14f1"]]);export{kt as default};
