import{U as f,P as p,j as d,u as $,v,i as g}from"./index-934f840a.js";import{d as w,c as y}from"./ContractHelper-e4143aaa.js";const l=v(),x={async getAccountBalance(e){if(!e)return;const t=await fetch(`${l.coreApiUrl}/extended/v1/address/${e}/stx`);if(t.status==200){const s=await t.json();return parseInt(s.balance)}},async getNFTHoldings(e,t,s,r,i,a){if(!e||!t||!s||!r)return;let n=`${l.coreApiUrl}/extended/v1/tokens/nft/holdings?principal=${r}&asset_identifiers=${e}.${t}::${s}`;i&&(n=n+`&limit=${i}`),a&&(n=n+`&offset=${a}`);const o=await fetch(n);if(o.status==200)return await o.json()},async resolveAddress(e){const t="Address invalid";if(!e||e.length==0)return{ret:-1,errMsg:t};if(e.indexOf(".")==-1)return{ret:0,value:e};const s=e.split(".");if(s.length!=2)return{ret:-2,errMsg:t};if(s[0].startsWith("SP")&&f.parseAddress(s[0]))return{ret:0,value:e};const r="SP2QEZ06AGJ3RKJPBV14SY1V5BBFNAW33D96YPGZF",i={contractAddress:r,contractName:"BNS-V2",functionName:"get-owner-name",functionArgs:[p(s[0].toLowerCase()),p(s[1].toLowerCase())],network:l,senderAddress:r},a=await w(i);let n=y(a);return n.type=="uint"?{ret:-1,errMsg:"BNS name not exists"}:{ret:0,value:n.value.value}},async queryNFTHistory(e,t,s,r,i){if(r)try{const a=i||0,n=`${l.coreApiUrl}/extended/v1/tokens/nft/history?asset_identifier=${e}.${t}::${s}&value=${d($(r))}&offset=${a}`,o=await fetch(n);if(o.status==200){const u=await o.json(),c=u.results.length>0?u.results[u.results.length-1]:null;if(c)return c.asset_event_type=="mint"?c.tx_id:await this.queryNFTHistory(e,t,s,r,a+50)}}catch{f.alert(`Request server fail, tokenId=${r}, please try again 1 minute later.`)}},async queryAddressNonceInfo(e){if(!e)return;const t=await fetch(`${l.coreApiUrl}/extended/v1/address/${e}/nonces`);if(t.status==200)return await t.json()},openTxInBrowser(e){if(e){const t=`https://explorer.hiro.so/txid/${e}?chain=${g()}`;window.open(t,"_blank")}}};export{x as C};
